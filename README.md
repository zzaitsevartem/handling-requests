# Система управления обращениями

Это простая система для создания и управления обращениями, созданная с использованием Express и Supabase.

## Требования

- Node.js (версия 16 или выше)
- Аккаунт и проект в Supabase
- Ключ `service_role` из Supabase (нужно добавить в файл `.env`)

## Установка и запуск

1. Распакуйте проект:
   - Скачайте и распакуйте архив проекта в любую папку на вашем компьютере.

2. Установите Node.js (если ещё не установлен):
   - Скачайте и установите Node.js с официального сайта: https://nodejs.org/ (рекомендуется версия 16 или выше).
   - Проверьте, что Node.js установлен, выполнив в терминале:
     ```
     node -v
     ```
     Должна отобразиться версия, например, `v16.20.0`.

3. Восстановите зависимости проекта:
   - Откройте терминал в папке проекта.
   - Выполните команду для установки всех необходимых библиотек:
     ```
     npm install
     ```
   - Это создаст папку `node_modules` и установит следующие библиотеки:
     - `@supabase/supabase-js` (версия 2.45.4) — для работы с базой данных Supabase.
     - `cors` (версия 2.8.5) — для обработки CORS-запросов.
     - `dotenv` (версия 16.4.5) — для работы с переменными окружения.
     - `express` (версия 4.21.0) — для создания сервера.
     - `express-session` (версия 1.18.0) — для управления сессиями.

4. Настройте файл `.env`:
   - Создайте файл `.env` в корне проекта, используя шаблон из `.env.example`:
     ```
     SUPABASE_URL=https://your-supabase-url.supabase.co
     SUPABASE_KEY=your-service-role-key
     ```
   - Замените значения на ваши:
     - `SUPABASE_URL` — URL вашего проекта Supabase.
     - `SUPABASE_KEY` — ваш ключ `service_role` (можно найти в Supabase: Project Settings > API > service_role key).

5. Настройте базу данных в Supabase:
   - Войдите в ваш проект Supabase: https://supabase.com/dashboard.
   - Перейдите в раздел **SQL Editor**.
   - Выполните следующий SQL-запрос, чтобы создать таблицу `table-project`:
     ```sql
     CREATE TABLE "table-project" (
         id SERIAL PRIMARY KEY,
         title TEXT NOT NULL,
         text TEXT NOT NULL,
         status TEXT NOT NULL,
         solution TEXT,
         cancelReason TEXT,
         createdAt TIMESTAMP NOT NULL,
         updatedAt TIMESTAMP
     );
     ```
   - Если вы хотите сбросить счётчик ID (чтобы новые обращения начинались с ID 1), выполните следующую команду:
     ```sql
     ALTER SEQUENCE "table-project_id_seq" RESTART WITH 1;
     ```
   - База данных готова и пуста, ID начинается с 1.

6. Запустите сервер:
   - В терминале в папке проекта выполните:
     ```
     npm start
     ```
   - Сервер запустится на порту 3000.

7. Откройте проект в браузере:
   - Страница создания обращения: `http://localhost:3000/create`
   - Страница управления обращениями: `http://localhost:3000/employee` (пароль: `pass123`)

## Возможности

- Создание обращений (на странице `/create`).
- Управление обращениями (на странице `/employee`): взятие в работу, завершение, отмена, удаление.
- Фильтрация обращений по дате или диапазону дат.
- Поддержка тёмной темы (кнопка переключения в правом верхнем углу).

## Использование

1. **Создание обращения**:
   - Перейдите на `http://localhost:3000/create`.
   - Заполните поля "Тема" и "Текст обращения".
   - Нажмите "Отправить". Вы увидите уведомление об успешном создании.

2. **Управление обращениями**:
   - Перейдите на `http://localhost:3000/employee`.
   - Введите пароль `pass123`.
   - Вы увидите список всех обращений.
   - **Действия**:
     - "Взять в работу" — для новых обращений.
     - "Завершить" — для обращений "в работе" (нужно указать решение).
     - "Отменить" — для обращений "в работе" (нужно указать причину).
     - "Очистить" — для завершённых или отменённых обращений (удаляет обращение).
   - **Фильтры**:
     - Выберите дату или диапазон дат и нажмите "Применить фильтр".
     - Нажмите "Отменить все 'в работе'" для массовой отмены (нужно указать причину).

3. **Переключение темы**:
   - Нажмите кнопку "Тёмная тема" (или "Светлая тема") в правом верхнем углу, чтобы сменить тему интерфейса.
